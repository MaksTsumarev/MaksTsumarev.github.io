<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Расчет сечения</title>
  <script>
    async function calculate() {
      const N = parseFloat(document.getElementById("inputN").value);
      const D = parseFloat(document.getElementById("inputD").value);
      const artikul = document.getElementById("inputArtikul").value;
      const lot = document.getElementById("inputLot").value;

      if (isNaN(D) || isNaN(N) || !artikul || !lot) {
        alert("Заполните все поля корректно!");
        return;
      }

      const result = (Math.PI * Math.pow(D, 2) * N) / 4;
      document.getElementById("result").innerText = "Результат: " + result.toFixed(4);

      // Сохраняем в Google Sheets
      const data = {
        artikul: artikul,
        lot: lot,
        d: D,
        n: N,
        result: result.toFixed(4)
      };

      const response = await fetch("https://script.google.com/macros/s/AKfycbyaoMyI_8h4ykY8Trs69SWyI8ENglGZBNpPLHu1fzYDSemZhSxT62LsEncitY3IF6X4/exec", {
        method: "POST",
        mode: "no-cors",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      });
    }
  </script>
</head>
<body>
  <h2>Расчет сечения</h2>

  <label>Артикул:</label><br>
  <input type="text" id="inputArtikul"><br><br>

  <label>LOT:</label><br>
  <input type="text" id="inputLot"><br><br>

  <label>Диаметр D:</label><br>
  <input type="number" id="inputD"><br><br>

  <label>Количество жил N:</label><br>
  <input type="number" id="inputN"><br><br>

  <button onclick="calculate()">Рассчитать и Сохранить</button>

  <p id="result"></p>
</body>
</html>
